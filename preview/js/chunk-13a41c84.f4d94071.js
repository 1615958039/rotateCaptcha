(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-13a41c84"],{"04c9":function(a,t,e){"use strict";e("7390")},"09a0":function(a,t,e){"use strict";e.r(t);var r=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("h2",[a._v("旋转验证码：")]),e("p",[a._v("(vue-cli版本)")]),e("el-button",{attrs:{icon:"el-icon-picture-outline-round",type:"primary"},on:{click:a.showCaptcha}},[a._v("打开验证码")]),e("el-button",{attrs:{icon:"el-icon-delete"},on:{click:a.cleanLog}},[a._v("清空验证记录")]),e("hr"),a._v(" 手机端测试页UNIAPP: "),e("a",{attrs:{href:"./uniapp.html"}},[a._v("./uniapp.html")]),e("hr"),a._v(" 本项目总开源地址："),e("a",{attrs:{href:"https://github.com/1615958039/rotateCaptcha"}},[a._v("https://github.com/1615958039/rotateCaptcha")]),e("hr"),e("captchaDialog",{ref:"captchaDialog"})],1)},i=[],c=function(){var a=this,t=a.$createElement,e=a._self._c||t;return a.show?e("div",{staticClass:"dialog",style:{zIndex:a.zIndex}},[e("div",{staticClass:"captche"},[e("div",{staticClass:"subhead"},[a._v("人机验证")]),e("div",{staticClass:"tips"},[a._v("滑动滑块,使图片角度为正")]),e("div",{staticClass:"image"},[""!=a.captchaSrc?e("div",{staticClass:"src",style:{backgroundImage:"url("+a.captchaSrc+")",transform:"rotate("+a.imageTransform+"deg)"}}):a._e(),a.pageLoading||a.captchaSrcLoading?e("div",{staticClass:"icon"},[e("i",{staticClass:"loading el-icon-loading"})]):a._e(),a.captchaError?e("div",{staticClass:"icon"},[e("i",{staticClass:"error el-icon-close"})]):a._e(),a.isDrag?e("div",{staticClass:"icon"},[e("div",{staticClass:"verticalArrow"}),e("div",{staticClass:"transverseArrow"})]):a._e()]),e("div",{staticClass:"capFoot"},[e("div",{ref:"slider",staticClass:"slider"},[e("div",{ref:"sliderItem",staticClass:"sliderItem clickActive-gray",class:a.captchaError?"shake":"",style:{left:a.sliderItemLeft+"px",backgroundColor:a.captchaError?"red":a.isDrag?"#409EFF":"#fff"},on:{touchstart:a.dragStart,touchmove:function(t){return t.preventDefault(),a.dragMove.apply(null,arguments)},touchend:a.dragEnd,mousedown:a.dragStart,mousemove:function(t){return t.preventDefault(),a.dragMove.apply(null,arguments)},mouseup:a.dragEnd,dragstart:a.dragStart,dragend:a.dragEnd,dragover:function(a){a.stopPropagation()},drop:a.dragMove}},[a.dragLoading||a.pageLoading||a.captchaSrcLoading?e("div",{staticClass:"i-loading"},[e("i",{staticClass:"el-icon-loading"})]):e("div",{staticClass:"i-drag",style:{backgroundImage:"url("+a.dragIcon+")"}})])])]),a._m(0),e("div",{staticClass:"close",on:{click:function(t){return t.stopPropagation(),a.close.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-circle-close"})])])]):a._e()},n=[function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"copyright"},[a._v(" 由"),e("a",[a._v("犭申")]),a._v("提供技术支持 ")])}],s=(e("a9e3"),e("d3b7"),null),o=null,d={props:{zIndex:{type:Number,default:999999999999}},data:function(){return{show:!1,captchaSrc:"",isDrag:!1,dragStartTime:0,dragUseTime:0,mouseTrackList:[],sliderItemInitX:0,sliderItemLeftMax:0,sliderItemLeft:0,captchaSrcLoading:!1,pageLoading:!1,dragLoading:!1,captchaError:!1}},computed:{imageTransform:function(){var a=this;return 0==a.sliderItemLeft?0:Math.ceil(360/a.sliderItemLeftMax*a.sliderItemLeft*100)/100},dragIcon:function(){var a=this,t="/preview/icon/png/drag_white.png",e="/preview/icon/png/drag_black.png";return a.captchaError||a.isDrag?t:e}},methods:{init:function(){var a=this;return new Promise((function(t,e){s=t,o=e,a.captchaSrc=!1,a.captchaError=!1,a.isDrag=!1,a.captchaSrcLoading=!1,a.pageLoading=!1,a.dragLoading=!1,a.show=!0,0==a.sliderItemLeftMax?(a.pageLoading=!0,setTimeout((function(){a.$nextTick((function(){var t=a.$refs.slider.getBoundingClientRect(),e=t.width,r=a.$refs.sliderItem.getBoundingClientRect();a.sliderItemInitX=r.left,a.sliderItemLeftMax=e-r.width,a.pageLoading=!1,a.getCaptchaSrc()}))}),500)):a.getCaptchaSrc()}))},dragStart:function(a){var t=this;return!t.dragLoading&&(!t.pageLoading&&(!t.captchaSrcLoading&&(t.mouseTrackList=[],t.dragStartTime=(new Date).getTime(),t.isDrag=!0,void t.addMouseTrack(a))))},dragMove:function(a){var t=this;if(t.dragLoading)return!1;if(t.pageLoading)return!1;if(t.captchaSrcLoading)return!1;if(!t.isDrag)return!1;var e=(a.changedTouches?a.changedTouches[0].clientX:a.clientX)-t.sliderItemInitX-30;e<0&&(e=0),e>t.sliderItemLeftMax&&(e=t.sliderItemLeftMax),t.sliderItemLeft=e,t.addMouseTrack(a)},dragEnd:function(a){var t=this;return!t.dragLoading&&(!t.pageLoading&&(!t.captchaSrcLoading&&(!!t.isDrag&&(t.addMouseTrack(a),t.isDrag=!1,t.dragLoading=!0,t.dragUseTime=(new Date).getTime()-t.dragStartTime,void t.checkCaptche()))))},getCaptchaSrc:function(){var a=this;a.captchaSrcLoading=!0,a.sliderItemLeft=0,a.captchaSrc="",a.$axios({url:"/public/captcha/getCaptcha.json"}).then((function(t){t.src&&(a.dragLoading=!1,a.captchaSrc="data:image/png;base64,".concat(t.src)),a.captchaSrcLoading=!1})).catch((function(t){a.captchaSrcLoading=!1,a.tw(t.message),setTimeout((function(){a.close()}),1e3)}))},addMouseTrack:function(){var a=this,t=""==a.mouseTrackList?a.dragStartTime:a.mouseTrackList[a.mouseTrackList.length-1].t,e=(new Date).getTime();t+200<=e&&a.mouseTrackList.push({r:Math.ceil(a.imageTransform/360*1e4)/100,t:e})},checkCaptche:function(){var a=this;a.$axios({url:"/public/captcha/checkCaptcha.json",datas:{rotationAngle:a.imageTransform,mouseTrackList:JSON.stringify(a.mouseTrackList),dragUseTime:a.dragUseTime,dragStartTime:a.dragStartTime,key_1:(new Date).getTime()*Math.random(),key_2:(new Date).getTime()*Math.random(),key_3:(new Date).getTime()*Math.random(),hash:(new Date).getTime()*Math.random(),md5Key:(new Date).getTime()*Math.random()},noTips:!0,returnErrorData:!0}).then((function(t){a.show=!1,s()})).catch((function(t){a.dragLoading=!1,a.captchaError=!0,setTimeout((function(){a.captchaError=!1,t.getNewCaptcha?a.getCaptchaSrc():(a.captchaSrcLoading=!1,a.sliderItemLeft=0)}),1e3)}))},close:function(){this.show=!1,o()}}},g=d,l=(e("04c9"),e("2877")),u=Object(l["a"])(g,c,n,!1,null,"42672cf8",null),h=u.exports,p={components:{captchaDialog:h},methods:{showCaptcha:function(){var a=this;this.$refs.captchaDialog.init().then((function(){a.$message({message:"验证成功！",type:"success"})})).catch((function(){a.$message({message:"验证码弹窗关闭",type:"warning"})}))},cleanLog:function(){var a=this;a.$axios({url:"/demo/resetTryNum.json",showLoading:"清空中..."}).then((function(t){a.tw("清空成功！您可重新获取验证码")}))}}},m=p,f=Object(l["a"])(m,r,i,!1,null,"704b4d2c",null);t["default"]=f.exports},7390:function(a,t,e){}}]);